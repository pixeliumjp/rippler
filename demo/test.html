<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Rippler｜WebGLリップルエフェクト</title>

		<!-- Prism.js CSS -->
		<link
			href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
			rel="stylesheet"
		/>
		<link
			href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
			rel="stylesheet"
		/>

		<style>
			body {
				font-family:
					-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					sans-serif;
				line-height: 1.6;
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
				background: #f5f5f5;
			}

			.container {
				background: white;
				border-radius: 8px;
				padding: 30px;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
			}

			h1, h2, h3 {
				color: #333;
			}

			.code-section {
				margin: 30px 0;
			}

			.code-header {
				background: #2d2d2d;
				color: white;
				padding: 10px 20px;
				border-radius: 8px 8px 0 0;
				font-size: 14px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.code-wrapper {
				position: relative;
				margin-bottom: 30px;
			}

			pre[class*="language-"] {
				margin: 0;
				border-radius: 0 0 8px 8px;
				font-size: 14px;
			}

			.copy-button {
				background: #4caf50;
				color: white;
				border: none;
				padding: 5px 15px;
				border-radius: 4px;
				cursor: pointer;
				font-size: 12px;
				transition: background 0.3s;
			}

			.copy-button:hover {
				background: #45a049;
			}

			.copy-button.copied {
				background: #2196f3;
			}

			.demo-area {
				background: #f8f8f8;
				border: 2px dashed #ddd;
				border-radius: 8px;
				padding: 40px;
				text-align: center;
				margin: 20px 0;
				position: relative;
				overflow: hidden;
			}

			.tab-container {
				display: flex;
				gap: 10px;
				margin-bottom: 20px;
			}

			.tab-button {
				padding: 10px 20px;
				background: #e0e0e0;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				transition: all 0.3s;
			}

			.tab-button.active {
				background: #2196f3;
				color: white;
			}

			.tab-content {
				display: none;
			}

			.tab-content.active {
				display: block;
			}

			.feature-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 20px;
				margin: 30px 0;
			}

			.feature-card {
				background: #f8f8f8;
				padding: 20px;
				border-radius: 8px;
				border: 1px solid #e0e0e0;
			}

			.line-numbers .line-numbers-rows {
				border-right: 1px solid #464646;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>🌊 Rippler.js - WebGLリップルエフェクト</h1>
			<p>
				WebGLを使用した美しい波紋エフェクトをWebページに追加するライブラリです。
			</p>

			<!-- タブナビゲーション -->
			<div class="tab-container">
				<button class="tab-button active" onclick="showTab('basic')">
					基本的な使い方
				</button>
				<button class="tab-button" onclick="showTab('advanced')">
					高度な使い方
				</button>
				<button class="tab-button" onclick="showTab('api')">
					API リファレンス
				</button>
				<button class="tab-button" onclick="showTab('examples')">
					実装例
				</button>
			</div>

			<!-- 基本的な使い方 -->
			<div id="basic" class="tab-content active">
				<h2>📦 インストール</h2>

				<div class="code-wrapper">
					<div class="code-header">
						<span>NPM</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre><code class="language-bash">npm install rippler-js</code></pre>
				</div>

				<div class="code-wrapper">
					<div class="code-header">
						<span>CDN</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-html">&lt;script type="module"&gt;
  import { Rippler } from 'https://cdn.jsdelivr.net/npm/rippler-js@latest/dist/rippler.min.js';
&lt;/script&gt;</code></pre>
				</div>

				<h2>🚀 クイックスタート</h2>

				<div class="code-wrapper">
					<div class="code-header">
						<span>HTML</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-html">&lt;!-- リップルエフェクトを適用する要素 --&gt;
&lt;div id="ripple-container" style="width: 100%; height: 400px; background-image: url('background.jpg');"&gt;
  &lt;h2&gt;美しい波紋エフェクト&lt;/h2&gt;
  &lt;p&gt;マウスを動かしてみてください&lt;/p&gt;
&lt;/div&gt;</code></pre>
				</div>

				<div class="code-wrapper">
					<div class="code-header">
						<span>JavaScript</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">// ESMインポート
import { Rippler } from './rippler.js';

// 要素を取得
const element = document.getElementById('ripple-container');

// Ripplerインスタンスを作成
const rippler = new Rippler(element, {
  dropRadius: 20,      // 波紋の半径
  perturbance: 0.03,   // 波の強さ
  interactive: true,   // インタラクティブモード
  resolution: 256      // テクスチャ解像度
});

// 手動で波紋を作成
rippler.drop(100, 100, 30, 0.05);</code></pre>
				</div>
			</div>

			<!-- 高度な使い方 -->
			<div id="advanced" class="tab-content">
				<h2>⚡ 高度な設定</h2>

				<div class="code-wrapper">
					<div class="code-header">
						<span>カスタム設定</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">const rippler = new Rippler(element, {
  // 画像設定
  imageUrl: '/path/to/custom-image.jpg',  // カスタム背景画像
  crossOrigin: 'anonymous',               // CORS設定
  
  // エフェクト設定
  dropRadius: 30,                         // 波紋の半径（ピクセル）
  perturbance: 0.05,                      // 波の歪み強度（0-1）
  resolution: 512,                        // テクスチャ解像度（2の累乗）
  
  // インタラクション
  interactive: true                       // マウス/タッチ反応
});

// 動的な設定変更
rippler.set('perturbance', 0.1);
rippler.set('dropRadius', 40);
rippler.set('imageUrl', '/new-image.jpg');</code></pre>
				</div>

				<h2>🎯 イベント駆動の波紋</h2>

				<div class="code-wrapper">
					<div class="code-header">
						<span>カスタムイベント</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">// クリックで大きな波紋
element.addEventListener('click', (e) => {
  const rect = element.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  // 大きな波紋を作成
  rippler.drop(x, y, 50, 0.1);
});

// 自動波紋アニメーション
let angle = 0;
setInterval(() => {
  const centerX = element.clientWidth / 2;
  const centerY = element.clientHeight / 2;
  const radius = 100;
  
  const x = centerX + Math.cos(angle) * radius;
  const y = centerY + Math.sin(angle) * radius;
  
  rippler.drop(x, y, 20, 0.04);
  angle += 0.1;
}, 100);</code></pre>
				</div>

				<h2>🎨 複数要素への適用</h2>

				<div class="code-wrapper">
					<div class="code-header">
						<span>複数インスタンス</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">// 複数の要素に異なる設定で適用
const ripplers = [];

document.querySelectorAll('.ripple-element').forEach((el, index) => {
  const rippler = new Rippler(el, {
    dropRadius: 20 + index * 10,
    perturbance: 0.02 + index * 0.01,
    resolution: 256
  });
  
  ripplers.push(rippler);
});

// 全ての波紋を一時停止
function pauseAll() {
  ripplers.forEach(r => r.pause());
}

// 全ての波紋を再開
function playAll() {
  ripplers.forEach(r => r.play());
}</code></pre>
				</div>
			</div>

			<!-- API リファレンス -->
			<div id="api" class="tab-content">
				<h2>📚 API リファレンス</h2>

				<h3>コンストラクタ</h3>
				<div class="code-wrapper">
					<div class="code-header">
						<span>new Rippler(element, options)</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">// パラメータ
// element: HTMLElement - リップルエフェクトを適用する要素
// options: Object - 設定オプション

const rippler = new Rippler(element, {
  imageUrl: null,        // string - 背景画像URL
  resolution: 256,       // number - テクスチャ解像度
  dropRadius: 20,        // number - 波紋の半径
  perturbance: 0.03,     // number - 波の強さ
  interactive: true,     // boolean - インタラクティブモード
  crossOrigin: ''        // string - CORS設定
});</code></pre>
				</div>

				<h3>メソッド</h3>

				<div class="feature-grid">
					<div class="feature-card">
						<h4>drop(x, y, radius, strength)</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// 指定位置に波紋を作成
rippler.drop(
  100,   // x座標
  100,   // y座標
  30,    // 半径
  0.05   // 強度
);</code></pre>
						</div>
					</div>

					<div class="feature-card">
						<h4>show() / hide()</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// エフェクトの表示/非表示
rippler.hide();
setTimeout(() => {
  rippler.show();
}, 1000);</code></pre>
						</div>
					</div>

					<div class="feature-card">
						<h4>pause() / play()</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// アニメーションの一時停止/再開
rippler.pause();
document.addEventListener('click', () => {
  rippler.play();
});</code></pre>
						</div>
					</div>

					<div class="feature-card">
						<h4>set(property, value)</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// プロパティの動的変更
rippler.set('perturbance', 0.1);
rippler.set('dropRadius', 40);
rippler.set('imageUrl', 'new.jpg');</code></pre>
						</div>
					</div>

					<div class="feature-card">
						<h4>updateSize()</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// キャンバスサイズの更新
window.addEventListener('resize', () => {
  rippler.updateSize();
});</code></pre>
						</div>
					</div>

					<div class="feature-card">
						<h4>destroy()</h4>
						<div class="code-wrapper">
							<pre>
<code class="language-javascript">// インスタンスの破棄
rippler.destroy();
// メモリとイベントリスナーをクリーンアップ</code></pre>
						</div>
					</div>
				</div>
			</div>

			<!-- 実装例 -->
			<div id="examples" class="tab-content">
				<h2>💡 実装例</h2>

				<h3>ヒーローセクション</h3>
				<div class="code-wrapper">
					<div class="code-header">
						<span>フルスクリーンヒーロー</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-html">&lt;section class="hero" id="hero-section"&gt;
  &lt;div class="hero-content"&gt;
    &lt;h1&gt;Welcome to Our Site&lt;/h1&gt;
    &lt;p&gt;Experience the ripple effect&lt;/p&gt;
    &lt;button class="cta-button"&gt;Get Started&lt;/button&gt;
  &lt;/div&gt;
&lt;/section&gt;

&lt;style&gt;
.hero {
  height: 100vh;
  background-image: url('hero-bg.jpg');
  background-size: cover;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.hero-content {
  text-align: center;
  color: white;
  z-index: 1;
  position: relative;
}
&lt;/style&gt;

&lt;script type="module"&gt;
import { Rippler } from './rippler.js';

const hero = document.getElementById('hero-section');
const rippler = new Rippler(hero, {
  dropRadius: 30,
  perturbance: 0.02,
  resolution: 512
});

// CTAボタンクリックで波紋
document.querySelector('.cta-button').addEventListener('click', (e) => {
  const rect = hero.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  // 大きな波紋を連続で作成
  for (let i = 0; i < 3; i++) {
    setTimeout(() => {
      rippler.drop(x, y, 40 + i * 20, 0.08);
    }, i * 200);
  }
});
&lt;/script&gt;</code></pre>
				</div>

				<h3>画像ギャラリー</h3>
				<div class="code-wrapper">
					<div class="code-header">
						<span>インタラクティブギャラリー</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">class RippleGallery {
  constructor(container) {
    this.container = container;
    this.items = container.querySelectorAll('.gallery-item');
    this.ripplers = new Map();
    
    this.init();
  }
  
  init() {
    this.items.forEach(item => {
      const rippler = new Rippler(item, {
        dropRadius: 25,
        perturbance: 0.04,
        interactive: false // 手動制御
      });
      
      this.ripplers.set(item, rippler);
      
      // ホバーエフェクト
      item.addEventListener('mouseenter', (e) => {
        this.createRippleEffect(item, e);
      });
      
      // クリックで全画面表示
      item.addEventListener('click', () => {
        this.showFullscreen(item);
      });
    });
  }
  
  createRippleEffect(item, event) {
    const rippler = this.ripplers.get(item);
    const rect = item.getBoundingClientRect();
    
    // 中心から外側へ広がる波紋
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;
    
    let radius = 0;
    const animate = () => {
      if (radius < Math.max(rect.width, rect.height)) {
        rippler.drop(centerX, centerY, radius, 0.02);
        radius += 10;
        requestAnimationFrame(animate);
      }
    };
    animate();
  }
  
  showFullscreen(item) {
    // フルスクリーン表示のロジック
    console.log('Showing fullscreen for', item);
  }
}

// 初期化
const gallery = new RippleGallery(document.querySelector('.gallery'));</code></pre>
				</div>

				<h3>背景アニメーション</h3>
				<div class="code-wrapper">
					<div class="code-header">
						<span>自動アニメーション背景</span>
						<button class="copy-button" onclick="copyCode(this)">
							コピー
						</button>
					</div>
					<pre>
<code class="language-javascript">class RippleBackground {
  constructor(element, options = {}) {
    this.element = element;
    this.rippler = new Rippler(element, {
      dropRadius: 40,
      perturbance: 0.01,
      interactive: true,
      ...options
    });
    
    this.patterns = {
      rain: this.rainPattern.bind(this),
      wave: this.wavePattern.bind(this),
      spiral: this.spiralPattern.bind(this),
      random: this.randomPattern.bind(this)
    };
    
    this.currentPattern = null;
    this.animationId = null;
  }
  
  startPattern(patternName = 'rain') {
    this.stopPattern();
    this.currentPattern = patternName;
    
    if (this.patterns[patternName]) {
      this.patterns[patternName]();
    }
  }
  
  stopPattern() {
    if (this.animationId) {
      cancelAnimationFrame(this.animationId);
      this.animationId = null;
    }
  }
  
  rainPattern() {
    const width = this.element.clientWidth;
    const height = this.element.clientHeight;
    
    const createDrop = () => {
      const x = Math.random() * width;
      const y = Math.random() * height;
      const size = 20 + Math.random() * 20;
      const strength = 0.02 + Math.random() * 0.03;
      
      this.rippler.drop(x, y, size, strength);
    };
    
    const animate = () => {
      if (Math.random() > 0.9) {
        createDrop();
      }
      this.animationId = requestAnimationFrame(animate);
    };
    animate();
  }
  
  wavePattern() {
    const width = this.element.clientWidth;
    const height = this.element.clientHeight;
    let offset = 0;
    
    const animate = () => {
      const y = height / 2 + Math.sin(offset) * height / 4;
      const x = (offset * 50) % (width + 100);
      
      this.rippler.drop(x, y, 30, 0.04);
      offset += 0.1;
      
      this.animationId = requestAnimationFrame(animate);
    };
    animate();
  }
  
  spiralPattern() {
    const centerX = this.element.clientWidth / 2;
    const centerY = this.element.clientHeight / 2;
    let angle = 0;
    let radius = 0;
    
    const animate = () => {
      const x = centerX + Math.cos(angle) * radius;
      const y = centerY + Math.sin(angle) * radius;
      
      this.rippler.drop(x, y, 25, 0.03);
      
      angle += 0.2;
      radius += 0.5;
      
      if (radius > Math.max(centerX, centerY)) {
        radius = 0;
      }
      
      this.animationId = requestAnimationFrame(animate);
    };
    animate();
  }
  
  randomPattern() {
    const width = this.element.clientWidth;
    const height = this.element.clientHeight;
    
    const animate = () => {
      if (Math.random() > 0.95) {
        const count = 1 + Math.floor(Math.random() * 3);
        
        for (let i = 0; i < count; i++) {
          setTimeout(() => {
            const x = Math.random() * width;
            const y = Math.random() * height;
            this.rippler.drop(x, y, 30, 0.05);
          }, i * 100);
        }
      }
      
      this.animationId = requestAnimationFrame(animate);
    };
    animate();
  }
}

// 使用例
const bg = new RippleBackground(document.querySelector('.animated-bg'));
bg.startPattern('spiral');

// パターンを切り替え
document.querySelectorAll('.pattern-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    bg.startPattern(btn.dataset.pattern);
  });
});</code></pre>
				</div>
			</div>

			<!-- デモエリア -->
			<div class="demo-area" id="demo">
				<h3>🎮 インタラクティブデモ</h3>
				<p>このエリアにマウスを動かしてみてください</p>
			</div>
		</div>

		<!-- Prism.js -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"
		></script>

		<script>
			// タブ切り替え
			function showTab(tabName) {
				// すべてのタブコンテンツを非表示
				document.querySelectorAll(".tab-content")
					.forEach((content) => {
						content.classList.remove("active");
					});

				// すべてのタブボタンを非アクティブ化
				document.querySelectorAll(".tab-button")
					.forEach((button) => {
						button.classList.remove("active");
					});

				// 選択されたタブを表示
				document.getElementById(tabName).classList.add(
					"active",
				);

				// 対応するボタンをアクティブ化
				event.target.classList.add("active");

				// Prismを再実行して新しいコードをハイライト
				Prism.highlightAll();
			}

			// コードコピー機能
			function copyCode(button) {
				const codeBlock = button.parentElement
					.nextElementSibling.querySelector("code");
				const text = codeBlock.textContent;

				navigator.clipboard.writeText(text).then(() => {
					button.textContent = "コピーしました！";
					button.classList.add("copied");

					setTimeout(() => {
						button.textContent = "コピー";
						button.classList.remove("copied");
					}, 2000);
				});
			}

			// 初期化時にPrismを実行
			document.addEventListener(
				"DOMContentLoaded",
				() => {
					Prism.highlightAll();
				},
			);

			// デモ用の簡易実装
			const demoArea = document.getElementById("demo");
			let demoInitialized = false;

			demoArea.addEventListener("mouseenter", () => {
				if (!demoInitialized) {
					demoArea.innerHTML = `
                    <h3>🎮 インタラクティブデモ</h3>
                    <p>WebGLがサポートされていない場合のフォールバック表示</p>
                    <div style="width: 100px; height: 100px; background: radial-gradient(circle, rgba(33,150,243,0.3) 0%, transparent 70%); 
                                margin: 20px auto; animation: pulse 2s infinite;">
                    </div>
                `;
					demoInitialized = true;
				}
			});

			// パルスアニメーション用CSS
			const style = document.createElement("style");
			style.textContent = `
            @keyframes pulse {
                0% { transform: scale(0.8); opacity: 0.5; }
                50% { transform: scale(1.2); opacity: 0.8; }
                100% { transform: scale(0.8); opacity: 0.5; }
            }
        `;
			document.head.appendChild(style);
		</script>
	</body>
</html>
